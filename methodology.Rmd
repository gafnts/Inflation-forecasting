# Datos y metodología

## Análisis de datos

\small

\textbf{Cuadro 1:} Variables empleadas durante el proceso de predicción

\normalsize

```{r include=FALSE}
pacman::p_load(tidyverse, kableExtra, here)
```

```{r include=FALSE}
table_one <- 
  tribble(
  ~ Variable, ~ Descripción, ~ Fuente,
  "ipc", "Tasa de variación interanual del índice de precios al consumidor", "INE",
  "tpm", "Tasa de interés de política monetaria", "BANGUAT",
  "m1", "Medio circulante (en millones de quetzales)", "SECMCA",
  "m2", "Medios de pago (en millones de quetzales)", "SECMCA",
  "imae", "Tasa de variación interanual del índice mensual de actividad económica (tendencia-ciclo)", "SECMCA",
  "deprate", "Tasa de interés pasiva real en moneda nacional", "SECMCA",
  "cred", "Crédito bancario al sector privado (en millones de quetzales)", "BANGUAT",
  "gov", "Gastos totales del gobierno central (en millones de quetzales)", "BANGUAT",
  "cpi", "Tasa de variación interanual del índice de precios al consumidor en Estados Unidos (ajustada por estacionalidad)", "FRED",
  "itcer", "Índice de tipo de cambio efectivo real con Estados Unidos", "SECMCA",
  "oil", "Precio internacional del petróleo (dólares por barril)", "FRED",
  "sugar", "Precio internacional del azúcar (centavos de dólar por libra)", "FRED"
  )
```

\renewcommand{\arraystretch}{1.5}

```{r table_one, echo=FALSE}
kbl(table_one, 
    booktabs = T, 
    align = c("cll")) %>%
  kable_styling(font_size = 9,
                full_width = T) %>% 
  row_spec(0, bold = TRUE, extra_css = 'vertical-align: middle !important;') %>% 
  column_spec(1, width = "1.5cm") %>% 
  column_spec(2, width = "11.9cm") %>% 
  group_rows(start_row = 1, 
             end_row = 12, 
             latex_align = "c",
             latex_gap_space = "-0.55cm")
```

\renewcommand{\arraystretch}{1}

\scriptsize

$^1$ INE: Instituto Nacional de Estadística\
$^2$ SECMCA: Secretaría Ejecutiva del Consejo Monetario Centroamericano\
$^3$ FRED: Federal Reserve Bank of St. Louis

\normalsize

\small

\textbf{Cuadro 2:} Estadísticas descriptivas

\normalsize

```{r include=FALSE}
library(e1071)

main <- read_csv(here("data", "main dataset.csv"))

main_longer <- 
  main %>% 
  pivot_longer(-fecha, names_to = "Variable", values_to = "value") %>% 
  arrange(Variable, fecha) %>% 
  group_by(Variable)

sumtable <- 
  main_longer %>% 
  summarise(Media = round(mean(value), 2),
            Mediana = round(median(value), 2),
            Mínimo = round(min(value), 2),
            Máximo = round(max(value), 2),
            `Desv. Est.` = round(sd(value), 2),
            Asimetría = round(skewness(value), 2),
            Curtosis = round(kurtosis(value), 2))

obs <- 
  main_longer %>% 
  count(Variable) %>% 
  rename(`Obs.` = n)

table_two <- 
  sumtable %>% 
  left_join(obs) %>% 
  slice(7, 13, 9, 10, 6, 3, 2, 5, 1, 8, 11, 12) %>% 
  as.data.frame()
```

\renewcommand{\arraystretch}{1.3}

```{r table_two, echo=FALSE}
kbl(table_two, 
    booktabs = T,
    align = c("c")) %>%
  kable_styling(font_size = 9,
                full_width = T) %>% 
  row_spec(0, bold = TRUE) %>% 
  column_spec(1, width = "1.5cm") %>% 
  column_spec(6, width = "1.8cm") %>% 
  column_spec(9, width = "0.8cm") %>% 
  group_rows(start_row = 1, 
             end_row = 12, 
             latex_align = "c",
             latex_gap_space = "-0.5cm")
```

\renewcommand{\arraystretch}{1}

\small

\textbf{Cuadro 3:} Pruebas estadísticas

\normalsize

```{r include=FALSE}
pacman::p_load(stats, tseries, pracma, broom)
names <- main_longer %>% distinct(Variable) %>% pull()
```

```{r include=FALSE}
autocorrelation <- function(data, variable) {
  data %>% 
    select(!!enquo(variable)) %>% 
    pull() %>% 
    as.ts() %>% 
    Box.test(., lag = 1, type = "Ljung-Box") %>% 
    tidy()
}

list <- list()
autocor <- data.frame()

for (i in names) {
  list <- autocorrelation(main, all_of(i))
  autocor <- rbind(autocor, list)
}

autocor %<>% 
  cbind(main_longer %>% distinct(Variable)) %>% 
  select(Variable, statistic, p.value) %>% 
  slice(7, 13, 9, 10, 6, 3, 2, 5, 1, 8, 11, 12) %>% 
  mutate(Autocorrelación = paste(round(statistic, 2), "(<0.01)", sep = " ")) %>% 
  select(Variable, Autocorrelación)
```

```{r}
jarque_bera <- function(data, variable) {
  data %>% 
    select(!!enquo(variable)) %>% 
    pull() %>% 
    as.ts() %>% 
    jarque.bera.test(.) %>% 
    tidy()
}

list <- list()
jarque <- data.frame()

for (i in names) {
  list <- jarque_bera(main, all_of(i))
  jarque <- rbind(jarque, list)
}

jarque %<>% 
  cbind(main_longer %>% distinct(Variable)) %>% 
  select(Variable, statistic, p.value) %>% 
  slice(7, 13, 9, 10, 6, 3, 2, 5, 1, 8, 11, 12) %>% 
  mutate(p.value = round(p.value, 4)) %>% 
  mutate(Normalidad = paste0(round(statistic, 2), " ", 
                             "(", format(p.value, scientific = FALSE), ")")) %>% 
  select(Variable, Normalidad)
```

```{r}
# Non-linearity
main_longer %>% 
  filter(Variable == "cpi") %>% 
  pull(value) %>% 
  as.ts() %>% 
  white.test(., lag = 1, qstar = 2, q = 10, range = 4, 
            type = c("Chisq","F"), scale = TRUE) %>% 
  tidy()

# Exponente de Hurst
main_longer %>% 
  filter(Variable == "cpi") %>% 
  pull(value) %>% 
  as.ts() %>% 
  hurstexp(., display = F) %>% 
  as_tibble()
```

## Métodos de pre-procesamiento

## Modelos, hiperparámetros y validación

## Medidas de precisión
