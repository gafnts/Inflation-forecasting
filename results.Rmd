# Resultados

```{r include=FALSE}
pacman::p_load(tidyverse, kableExtra, magrittr, here)
```

```{r include=FALSE}
setwd(here("results"))
knn <- read_csv("knn_24_forecast.csv") %>% mutate(key = "knn")
lstm <- read_csv("lstm_24_forecast.csv") %>% mutate(key = "lstm")
mlp <- read_csv("mlp_24_forecast.csv") %>% mutate(key = "mlp")
rf <- read_csv("rf_24_forecast.csv") %>% mutate(key = "rf")
svm <- read_csv("svm_24_forecast.csv") %>% mutate(key = "svm")
xgb <- read_csv("xgb_24_forecast.csv") %>% mutate(key = "xgb")
setwd(here())
```

```{r include=FALSE}
main <- read_csv(here("data", "main.csv")) %>% 
  select(fecha, ipc) %>% 
  rowid_to_column(".row")

ml_forecasts <- 
  list(knn, mlp, rf, svm, xgb) %>% 
  reduce(bind_rows) %>% 
  select(-ipc) %>% 
  pivot_wider(names_from = key, values_from = .pred) %>% 
  bind_cols(lstm %>% select("lstm" = .pred))
```

\renewcommand{\arraystretch}{1}

```{=tex}
\begin{center}

\small

\textbf{Figura 3:} Pronósticos de mediano plazo, modelos de aprendizaje estadístico

\end{center}
```
\vspace{-12mm}

```{r fig_three, echo=FALSE, warning=FALSE, message=FALSE, fig.align = 'center', fig.dim = c(11.5, 4.7)}
main %>% 
  left_join(ml_forecasts) %>% 
  select(-.row) %>% 
  filter(between(fecha, as.Date("2017-01-01"), as.Date("2021-12-01"))) %>% 
  pivot_longer(!fecha, names_to = "model", values_to = "value") %>% 
  arrange(model, fecha) %>% 
  ggplot() +
  geom_line(aes(fecha, value, color = model)) +
  theme_bw() +
  theme(
        # X axis
        axis.title.x = element_blank(),
        axis.text.x = element_text(size = 12),
        # Y axis
        axis.title.y = element_blank(),
        axis.text.y = element_text(size = 12),
        # Panel
        panel.grid = element_blank(),
        panel.grid.minor = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.background = element_rect(fill = "white"),
        # Legend
        legend.title = element_blank(),
        legend.text = element_text(size = 11),
        legend.position = "bottom",
        legend.justification = "center",
        legend.margin = margin(.5, 0, 0, 0, "cm")
    ) + 
    guides(colour = guide_legend(nrow = 1))
```
